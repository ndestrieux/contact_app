{% load crispy_forms_tags %}


<form method="post" id="person-update">

    <!-- Person modal -->

    <div id="person-modal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Person modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Person</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    {{ form.first_name|as_crispy_field }}
                    {{ form.last_name|as_crispy_field }}
                    {{ form.description|as_crispy_field }}
                    <script type="text/javascript">
                        {% if form.errors %}
                            $("#person-modal").modal("show");
                        {% endif %}
                    </script>
                </div>
                <div class="modal-footer">
                    <input type="submit" class="btn btn-outline-primary" value="Save">
                    {% csrf_token %}
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Address modal -->

    {{ address_forms.management_form }}
    {{ address_forms.non_form_errors }}
    {% for address_form in address_forms %}
        <div id="address-{{ address_form.id.value }}-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Address modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        {% if address_form.type.value == 1 %}
                            <h4 class="modal-title">Primary address</h4>
                        {% elif address_form.type.value == 2 %}
                            <h4 class="modal-title">Secondary address</h4>
                        {% endif %}
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        {{ address_form.id }}
                        {{ address_form|crispy }}
                        <script type="text/javascript">
                            {% if address_form.errors %}
                                $("#address-{{ address_form.id.value }}-modal").modal("show");
                            {% endif %}
                        </script>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-outline-primary" value="Save">
                        {% csrf_token %}
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}

    <!-- Phone modal -->

    {{ phone_forms.management_form }}
    {{ phone_forms.non_form_errors }}
    {% for phone_form in phone_forms %}
        <div id="phone-{% if phone_form.id %}{{ phone_form.id.value }}{% else %}None{% endif %}-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Phone modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Phone</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        {{ phone_form.id }}
                        {{ phone_form|crispy }}
                        <script type="text/javascript">
                            {% if phone_form.errors %}
                                $("#phone-{% if phone_form.id %}{{ phone_form.id.value }}{% else %}None{% endif %}-modal").modal("show");
                            {% endif %}
                        </script>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-outline-primary" value="Save">
                        {% csrf_token %}
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}

    <!-- Email modal -->
    {{ email_forms.management_form }}
    {{ email_forms.non_form_errors }}
    {% for email_form in email_forms %}
        <div id="email-{% if email_form.id %}{{ email_form.id.value }}{% else %}None{% endif %}-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">

                <!-- Email modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Email</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        {{ email_form.id }}
                        {{ email_form|crispy }}
                        <script type="text/javascript">
                            {% if email_form.errors %}
                                $("#email-{% if email_form.id %}{{ email_form.id.value }}{% else %}None{% endif %}-modal").modal("show");
                            {% endif %}
                        </script>
                    </div>
                    <div class="modal-footer">
                        <input type="submit" class="btn btn-outline-primary" value="Save">
                        {% csrf_token %}
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}

    <!-- Group modal -->

    <div id="group-modal" class="modal fade" role="dialog">
        <div class="modal-dialog">

            <!-- Group modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Groups</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                    {{ form.groups|as_crispy_field }}
                    <script type="text/javascript">
                        {% if form.errors %}
                            $("#group-modal").modal("show");
                        {% endif %}
                    </script>
                </div>
                <div class="modal-footer">
                    <input type="submit" class="btn btn-outline-primary" value="Save">
                    {% csrf_token %}
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</form>